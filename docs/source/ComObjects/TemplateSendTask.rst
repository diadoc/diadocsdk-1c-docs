TemplateSendTask
================

Задание для отправки шаблона пакета документов


.. rubric:: Свойства

:OperationId:
  **Строка, чтение/запись** - уникальный идентификатор операции (строка не чувствительная к регистру, может отсутствовать).

:ToBoxId:
  **Строка, чтение/запись** - идентификатор ящика получателя шаблона. Для внутреннего документа этот идентификатор должен содержать пустую строку

:MessageFromBoxId:
  **Строка, чтение/запись** - идентификатор ящика отправителя документа, созданного из шаблона

:MessageToBoxId:
  **Строка, чтение/запись** - идентификатор ящика получателя документа, созданного из шаблона

:MessageToDepartmentId:
  **Строка, чтение/запись** - идентификатор подразделения в ящике получателя документа, в которое будет маршрутизироваться документ

:LockMode:
  **Строка, чтение/запись** - режим блокировки шаблонов документов. :doc:`Возможные значения <./Enums/LockMode>`

:IsReusable:
  **Булево, чтение/запись** - тип переиспользования шаблона: true - создавать многоразовый шаблон, false - одноразовый (по-умолчанию false)

:Templates:
  :doc:`коллекция <Collection>` **объектов** :doc:`TemplateToSend` **, чтение** - шаблоны документов, добавленные в пакет


.. rubric:: Методы

+---------------------------------+--------------------------+
| |TemplateSendTask-AddTemplate|_ | |TemplateSendTask-Send|_ |
+---------------------------------+--------------------------+

.. |TemplateSendTask-AddTemplate| replace:: AddTemplate()
.. |TemplateSendTask-Send| replace:: Send()



.. _TemplateSendTask-AddTemplate:
.. method:: TemplateSendTask.AddTemplate(DocumentType)

  :DocumentType: ``строка`` идентификатор типа документа

  Добавляет новый элемент в коллекцию и возвращает его. Параметр *DocumentType* - значение *DocumentTypeDescription.Name*, полученное методом :meth:`Organization.GetDocumentTypes`


.. _TemplateSendTask-Send:
.. method:: TemplateSendTask.Send()

  Отправляет шаблон пакета документов на сервер Диадок. Возвращает :doc:`отправленнный шаблон <Template>`.
  Если отправка шаблона с заполненным *OperationId* завершилась успехом, то все остальные попытки отправки с тем же идентификатором не будут приводить к отправке нового шаблона, а в результате выполнения метода вернется ранее отправленный шаблон



.. seealso:: :doc:`../HowTo/HowTo_template`
