Как загрузить компоненту в приложении
=====================================

У компоненты есть две сборки: ``Addin`` и ``COM``

Компонента ``Addin`` отличается от ``COM`` только идентификаторами интерфейсов и наличием дополнительного интерфейса для подключения к 1С.

В остальном они одинаковые.


В случае запуска компоненты **64-битным приложением**, необходимо использовать **64-битную сборку** компоненты

**Ключ разработчика** представляет собой последовательность символов, идентифицирующий разработчика интеграционного решения.
`Оставить заявку на ключ <https://www.diadoc.ru/integrations/api#order-form-integration>`_


.. rubric:: Загрузка ``Addin`` компоненты

Подключить компоненту ``Addin`` можно двумя способами:

* Загрузка компоненты как Addin компоненты в 1С

.. code-block:: c#

    //Загрузка внешней компоненты
    ИмяФайла = "C:\Temp\AddInDiadocAPI.dll";
    ЗагрузитьВнешнююКомпоненту(ИмяФайла);

    //Создание объекта DiadocInvoiceAPI
    DiadocApi_ = Новый("AddIn.DiadocInvoiceAPI");
    DiadocApi  = DiadocApi_.CreateObject();

    //Задаем параметры подлючения к серверу
    DiadocApi.ApiClientId = КлючРазработчика;
    DiadocApi.ServerUrl   = "https://diadoc-api.kontur.ru:443";


* Загрузка компоненты как классический COM-объект

Данный способ загрузки компоненты может использоваться для загрузки компоненты, например, на сервере 1С

.. code-block:: c#

  //создаем корневой элемент COM-объекта
  DiadocApi = Новый ComОбъект("Diadoc.Api.InvoiceApi");

  //Задаем параметры подлючения к серверу
  DiadocApi.ApiClientId = КлючРазработчика;
  DiadocApi.ServerUrl   = "https://diadoc-api.kontur.ru:443";



.. rubric:: Загрузка ``COM`` компоненты

``COM`` компоненту можно загрузить только как классический COM-объект

.. code-block:: c#

    //создаем корневой элемент COM-объекта
    DiadocApi = Новый ComОбъект("Diadoc.DiadocClient");

    //Задаем параметры подлючения к серверу
    DiadocApi.ApiClientId = КлючРазработчика;
    DiadocApi.ServerUrl   = "https://diadoc-api.kontur.ru:443";




Перед загрузкой компоненты как классический COM-объект необходимо её :doc:`зарегистрировать <HowTo_register>`
